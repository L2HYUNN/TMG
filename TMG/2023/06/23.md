# 06/23 (금)

## 이팩티브 기술 면접 피드백 기능
피드백 기능 개발이 3주 정도 지연된 거 같다.

처음에 금방 끝낼수 있겠다는 자신감과 달리 개발을 하면 할수록 수정 및 추가 기능이 필요한 부분이 많았다. 

### 복잡한 컵포넌트
지난 과정을 잠시 돌이켜 보면 처음에는 하나의 컴포넌트가 모든 로직과 UI를 담당하고 있었다. 기간안에 빠르게 개발하려고 하다보니 아무래도 컴포넌트 분리에 신경을 못썼던 것 같았다. 이러한 복잡한 컴포넌트에 기능 하나 추가하는 것이 그렇게 어려울 것이라고는 당시에는 상상하지 못했다.

피드백 기능을 막 추가하려고 했을 때 피드백 기능뿐 아닌 새로운 버튼과 인풋이 추가되면서 상당히 구현이 까다롭다는 것을 깨닫게 되었다. 빠르게 깨닫고 컴포넌트를 분리하려고 했다면 좋았겠지만 복잡한 하나의 컴포넌트를 잡고 3시간 넘게 고민했던 거 같다.

결국 나중을 위해서라도 사실은 지금 당장의 개발을 위해서라도 컴포넌트를 분리하는 것이 맞다고 판단하였고 분리 작업을 바로 시작하였다. 이 작업은 상당히 많은 시간을 소요하였는데 아무래도 서비스의 가장 주요한 로직을 분리하는 작업이었기에 고려해야할 것들이 많았다.

### 복잡한 API
그렇게 오랜 시간을 들여 컴포넌트를 분리하고 다시 피드백 기능 추가 작업에 들어갔으나 두 번째 큰 문제를 만나게 되었다. 기존 질문 관련 API는 하나의 호출에 3가지 작업을 하고 있었다. 유저의 답변을 저장하고 다시 질문 목록을 호출하였을 때, 즉 질문 목록을 다시 호출하였을 때 멤버의 답변 저장, 새로운 꼬리 질문 생성, 그에 따른 AI 답변을 한 번에 생성하고 있었다. 그렇기에 이 API를 가지고 작업하는 것은 상당히 까다로운 일이었다. 호출과 원하는 결과가 일치하지 않았기에 일부로 결과를 숨기고 필요할 때 다시 가져와야만 했다.

처음에는 이 문제가 그렇게 심각하지 않다고 생각했지만 고민을 하면 할수록 아무래도 API를 변경할 필요가 있다고 판단했고 그 주 회의에 바로 이 안건에 대하여 팀원들에게 이야기하였다. 다행히 팀의 백엔드 개발자분도 의견에 동감을 해주셨기에 API를 재설계하는 것으로 방향을 잡게되었고 바로 재설계 작업에 들어갔다.

이팩티브 기술 면접의 API는 명세서부터 상당히 복잡했는데 사용하지 않는 API들이 명세서의 가독성과 이해를 헤쳤고 하나의 API가 다양한 기능을 하면서 명세서를 봐도 동작을 제대로 이해하지 못하는 경우가 많았다.

그렇기에 먼저 안 쓰는 API를 목록화 하여 함께 정리하고 기존 질문 관련 API를 모두 새로 설계하였다. 가장 중심적으로 고려한 부분은 바로 하나의 API가 명확하게 하나의 기능만 하게 만드는 것이었고 이 과정은 생각만큼 오래걸리지는 않았다. 이후 며칠 뒤 깔끔해진 명세서와 명확해진 API를 받아볼 수 있었다.

### 기능 개발
시간이 지나 오늘 새로운 API를 이용한 작업에 들어갔지만 기존에 있던 코드를 하나 하나 수정하면서 새로운 기능을 동시에 개발해야 했기에 생각 이상의 많은 시간이 소요되었다.

> 이 기능 개발 부분은 한 번 글로 정리할 수 있으면 좋을 것 같다.

사실 오늘 개발을 진행하면서 더욱 오랜 시간이 걸린 이유는 따로 있다. 바로 어제 읽은 함수형 프로그래밍에서 계층형 설계에 대한 부분을 일부 읽었기 때문이다. 읽은 내용을 토대로 이번 개발에 적용할 수 있을 것 같아 계층형 설계를 생각하느라 시간이 더 오래걸렸다.

오늘 설계를 진행하며 고려한 부분을 정리해보자.

### 설계와 생각
먼저 전체적인 컴포넌트 구조를 살펴보았다. Next를 사용하고 있었기에 기본적으로 컴포넌트는 Pages 폴더를 통해 사용되어진다. 즉 가장 상위에는 Pages 계층이 존재하고 있다. Pages에는 어떠한 것들이 들어가야할까?

#### Pages
먼저 당연하게 해당 페이지에 맞는 컴포넌트가 들어가야 할 것이다. 하지만 컴포넌트와 관련한 로직은 최대한 들어나지 않는 것이 좋을 것 같다. Pages를 통해 한 번에 페이지의 전체적인 컴포넌트가 눈에 들어와야 한다. 그렇기에 컴포넌트를 조작하는 로직은 최대한 추상화된 컴포넌트 들이 담당해야 한다고 생각하였다.

#### 컴포넌트
그렇게 페이지에 있던 로직들을 모두 컴포넌트 안으로 숨기기로 결정하였다. 처음에는 깊은 추상화 header, questions, footer와 같은 높은 수준을 유지하였지만 조금 더 컴포넌트 구조가 눈에 들어오는 것이 좋겠다는 생각에 footer의 구성인 button과 Input이 들어날 수 있게 변경하였다.

이후 컴포넌트 내부로 들어오자 너무나 복잡한 로직과 UI들이 나를 반기고 있었다. 어떻게하면 계층을 나누면서도 컴포넌트를 잘 분리할 수 있을까 고민하다가 어떻게 보면 가장 쉽게 UI와 그 외의 로직을 분리하기로 결정하였다. 컴포넌트의 UI와 관련한 부분을 담당하는 UI 컴포넌트 계층을 만들어 모든 컴포넌트의 UI가 해당 계층에서 반영될 수 있게 분리하려고 하였다. 

이후 Application 계층을 만들어 UI 컴포넌트를 이용하여 서비스에 필요한 여러 로직을 담당할 수 있게 하였다. 아직 보완 및 수정 해야할 부분이 매우 많지만 계층을 분리하니 컴포넌트별로 더욱 명확한 역할과 책임을 부여할 수 있었고 더욱 작은 컴포넌트를 유지할 수 있게 되었다.

덕분에 UI와 관련된 부분은 UI 계층에서만 작업할 수 있게 되었고 컴포넌트 로직과 관련된 부분은 Application 계층에서 작업할 수 있게 되었다. 물론 완벽하지 않아 의존성을 가지고 있을 가능성이 매우 매우 높다.

또한 높게 추상화된 컴포넌트 덕분에 Pages는 짧고 직관적인 구조를 가질 수 있게 되었다. Pages에서는 필요한 데이터를 관리하고 필요한 컴포넌트에 제공한다.

## 결론
계속하여 피드백 기능을 개발하는 중이다.

우여곡절이 많았지만 그 만큼 배워가는 것이 많은 것 같다.

특히 이번에 계층적으로 사고하고 컴포넌트의 역할과 책임에 대해서 깊게 고민하면서 좋은 컴포넌트 구조에 대해서 학습할 수 있었다.

추후 피드백 기능 개발이 끝나면 계층형 사고를 이용하여 컴포넌트 구조를 모두 리팩토링해보면 좋을 것 같다.

특히 모든 코드에 있는 컴포넌트들의 추상화 수준을 동일하게 유지할 수 있게 만들면 좋을 것 같다. 

